<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-TW&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.0.0-rc.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.0.0-rc.0" type="image/png" sizes="32x32"><meta name="description" content="Previous       We have built a 4G&#x2F;LTE router but how do I know its network usage? How much will it cost me?                     Goal       We are now going to write a Python scrip">
<meta property="og:type" content="article">
<meta property="og:title" content="Network usage monitor using Python">
<meta property="og:url" content="https://newjerseystyle.github.io/en/2020/Network-usage-monitor-using-Python/index.html">
<meta property="og:site_name" content="ExpShare">
<meta property="og:description" content="Previous       We have built a 4G&#x2F;LTE router but how do I know its network usage? How much will it cost me?                     Goal       We are now going to write a Python scrip">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-10T09:15:36.000Z">
<meta property="article:modified_time" content="2020-04-10T10:49:51.875Z">
<meta property="article:author" content="NewJerseyStyle">
<meta property="article:tag" content="Raspberry Pi">
<meta property="article:tag" content="Python3">
<meta property="article:tag" content="Monitoring">
<meta property="article:tag" content="Email">
<meta property="article:tag" content="Coding">
<meta name="twitter:card" content="summary"><meta name="keywords" content="NewJerseyStyle, ExpShare"><meta name="description" content="Share experience in software development"><title>Network usage monitor using Python</title><link ref="canonical" href="https://newjerseystyle.github.io/en/2020/Network-usage-monitor-using-Python/"><link rel="alternate" href="/atom.xml" type="application/atom+xml"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.0.0-rc.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/softdev/"><span class="header-nav-menu-item__icon"><i class="fas fa-laptop-code"></i></span><span class="header-nav-menu-item__text">Coding</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/toolz/"><span class="header-nav-menu-item__icon"><i class="fas fa-toolbox"></i></span><span class="header-nav-menu-item__text">Tools</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Network usage monitor using Python</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-04-10</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2020-04-10</span></span></div></header><div class="post-body"><!-- # Network usage monitor using Python -->

        <h2 id="Previous"   >
          <a href="#Previous" class="heading-link"><i class="fas fa-link"></i></a>Previous</h2>
      <p>We have <a href="/en/2020/Raspberry-Pi-as-4G-LTE-Router/">built a 4G/LTE router</a> but how do I know its network usage? How much will it cost me?</p>

        <h2 id="Goal"   >
          <a href="#Goal" class="heading-link"><i class="fas fa-link"></i></a>Goal</h2>
      <p>We are now going to write a Python script to send Email notificatoin for network usage and set a threshold for it.</p>
<blockquote>
<p>I assume you know the basic pattern how to code in Python</p>
</blockquote>

        <h2 id="Requirements-txt"   >
          <a href="#Requirements-txt" class="heading-link"><i class="fas fa-link"></i></a>Requirements.txt</h2>
      <figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">psutil</span><br><span class="line">python_http_client</span><br><span class="line">sendgrid</span><br></pre></td></tr></table></div></figure>

<p>You can install them by typing in terminal:</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install psutil python_http_client sendgrid</span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>You may need to specify <strong><code>pip3</code></strong> in Raspbian as both Python 2.x and Python 3.x were installed.</p>
</blockquote>

        <h2 id="Coding-Python"   >
          <a href="#Coding-Python" class="heading-link"><i class="fas fa-link"></i></a>Coding Python</h2>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir network-monitor</span><br><span class="line">$ <span class="built_in">cd</span> network-monitor</span><br><span class="line">$ nano monitor.py</span><br></pre></td></tr></table></div></figure>
<p>And then we start coding</p>

        <h3 id="Get-network-usage"   >
          <a href="#Get-network-usage" class="heading-link"><i class="fas fa-link"></i></a>Get network usage</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"></span><br><span class="line">NETWORK_INTERFACE = <span class="string">'ppp0'</span></span><br><span class="line"></span><br><span class="line">netio = psutil.net_io_counters(pernic=<span class="literal">True</span>)</span><br><span class="line">net_usage = netio[NETWORK_INTERFACE].bytes_sent + netio[NETWORK_INTERFACE].bytes_recv</span><br><span class="line"></span><br><span class="line">print(net_usage, <span class="string">"bytes"</span>)</span><br></pre></td></tr></table></div></figure>
<p>It will show you how many bytes it has transfered for upload and download.</p>
<blockquote>
<p>If it shows zero, change <strong><code>NETWORK_INTERFACE</code></strong> to <strong><code>wwan0</code></strong>.</p>
</blockquote>

        <h3 id="Set-threshold"   >
          <a href="#Set-threshold" class="heading-link"><i class="fas fa-link"></i></a>Set threshold</h3>
      <figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"></span><br><span class="line">NETWORK_INTERFACE = <span class="string">'wwan0'</span></span><br><span class="line">NETWORK_LIMIT = <span class="number">5000000</span> <span class="comment"># 5GB in SI standard</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  netio = psutil.net_io_counters(pernic=<span class="literal">True</span>)</span><br><span class="line">  net_usage = netio[NETWORK_INTERFACE].bytes_sent + netio[NETWORK_INTERFACE].bytes_recv</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> net_usage &gt; NETWORK_LIMIT:</span><br><span class="line">    print(<span class="string">"Meets network limit!"</span>)</span><br><span class="line"></span><br><span class="line">    print(net_usage, <span class="string">"bytes has been used"</span>)</span><br></pre></td></tr></table></div></figure>
<p>Once it over the <code>NETWORK_LIMIT</code> it will print a lot of lines of “Meets network limit!”. We can add a timer to check the network limit every X second.</p>

        <h3 id="Separate-the-config-and-code"   >
          <a href="#Separate-the-config-and-code" class="heading-link"><i class="fas fa-link"></i></a>Separate the config and code</h3>
      <p>Try to separate the cnofiguratoin and the Python script so we can reuse this project on other devices.</p>
<p><code>configparser</code> is really a good helper on this.</p>
<p>Create a file <code>monitor.conf</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Email]</span><br><span class="line">SENDGRID_API_KEY &#x3D; Your.Keyfrom_SendGrid</span><br><span class="line">from &#x3D; helper@raspberry.pi</span><br><span class="line">to &#x3D; your@email.address</span><br><span class="line">subject &#x3D; From your Raspberry Pi</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">INTERFACE &#x3D; wwan0</span><br><span class="line">LIMIT &#x3D; 45000000000</span><br><span class="line"></span><br><span class="line">[Misc]</span><br><span class="line">TIME_INTER &#x3D; 36</span><br></pre></td></tr></table></div></figure>

<p>Now we can load the configuration in Python</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.optionxform = str  <span class="comment">#reference: http://docs.python.org/library/configparser.html</span></span><br><span class="line">config.read(<span class="string">'monitor.conf'</span>)</span><br><span class="line"></span><br><span class="line">NETWORK_INTERFACE = config.get(<span class="string">'Network'</span>, <span class="string">'INTERFACE'</span>)		<span class="comment"># Define interface to check</span></span><br><span class="line">NETWORK_LIMIT = int(config.get(<span class="string">'Network'</span>, <span class="string">'LIMIT'</span>))			<span class="comment"># Define network limit</span></span><br><span class="line">SENDGRID_API_KEY = config.get(<span class="string">'Email'</span>, <span class="string">'SENDGRID_API_KEY'</span>)	<span class="comment"># Define the API key for SendGrid</span></span><br><span class="line">TIME_INTER = config.get(<span class="string">'Misc'</span>, <span class="string">'TIME_INTER'</span>)				<span class="comment"># Define time interval 36 seconds</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  time.sleep(TIME_INTER) <span class="comment"># Check every 36 seconds</span></span><br><span class="line">  netio = psutil.net_io_counters(pernic=<span class="literal">True</span>)</span><br><span class="line">  net_usage = netio[NETWORK_INTERFACE].bytes_sent + netio[NETWORK_INTERFACE].bytes_recv</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> net_usage &gt; NETWORK_LIMIT:</span><br><span class="line">    print(<span class="string">"Meets network limit!"</span>)</span><br><span class="line"></span><br><span class="line">    print(net_usage, <span class="string">"bytes has been used"</span>)</span><br></pre></td></tr></table></div></figure>


        <h3 id="Prepare-for-the-Email"   >
          <a href="#Prepare-for-the-Email" class="heading-link"><i class="fas fa-link"></i></a>Prepare for the Email</h3>
      <p>We use SendGrid to send the Email notification in this tutorial.</p>
<blockquote>
<p>You may need to sign up on SendGrid. I choose it because of 100 free email quota every day.</p>
</blockquote>

        <h4 id="Generate-SendGrid-API-Key"   >
          <a href="#Generate-SendGrid-API-Key" class="heading-link"><i class="fas fa-link"></i></a>Generate SendGrid API Key</h4>
      <p>The option is in <strong>Setting -&gt; API Keys -&gt; Create API Key</strong> <span class="exturl"><a class="exturl__link"   href="https://sendgrid.com/docs/ui/account-and-settings/api-keys/#creating-an-api-key"  target="_blank" rel="noopener">Creating an API key</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h4 id="Copy-the-Key-and-paste-to-monitor-conf"   >
          <a href="#Copy-the-Key-and-paste-to-monitor-conf" class="heading-link"><i class="fas fa-link"></i></a>Copy the Key and paste to monitor.conf</h4>
      <figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Email]</span><br><span class="line">SENDGRID_API_KEY &#x3D; Your.Keyfrom_SendGrid</span><br></pre></td></tr></table></div></figure>


        <h3 id="Write-python-script"   >
          <a href="#Write-python-script" class="heading-link"><i class="fas fa-link"></i></a>Write python script</h3>
      <p>Refer to their official guide <span class="exturl"><a class="exturl__link"   href="https://github.com/sendgrid/sendgrid-python"  target="_blank" rel="noopener">SendGrid GitHub repo</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"><span class="keyword">import</span> sendgrid</span><br><span class="line"><span class="keyword">from</span> sendgrid.helpers.mail <span class="keyword">import</span> *</span><br></pre></td></tr></table></div></figure>
<p>Read the <code>monitor.conf</code></p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config.optionxform = str  <span class="comment">#reference: http://docs.python.org/library/configparser.html</span></span><br><span class="line">config.read(<span class="string">'netio-mon.conf'</span>)</span><br><span class="line"></span><br><span class="line">NETWORK_INTERFACE = config.get(<span class="string">'Network'</span>, <span class="string">'INTERFACE'</span>)</span><br><span class="line">NETWORK_LIMIT = int(config.get(<span class="string">'Network'</span>, <span class="string">'LIMIT'</span>))</span><br><span class="line">NETWORK_MAX = int(config.get(<span class="string">'Network'</span>, <span class="string">'MAX'</span>))</span><br><span class="line">SENDGRID_API_KEY = config.get(<span class="string">'Email'</span>, <span class="string">'SENDGRID_API_KEY'</span>)</span><br><span class="line">TIME_INTER = config.get(<span class="string">'Misc'</span>, <span class="string">'TIME_INTER'</span>)</span><br></pre></td></tr></table></div></figure>
<p>I would like to have some loggings too so I added this line</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">loggingFile = logging.FileHandler(<span class="string">'my.log'</span>, <span class="string">'w'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">        format=<span class="string">'%(asctime)s %(levelname)s %(message)s'</span>,</span><br><span class="line">        datefmt=<span class="string">'%Y-%m-%d %H:%M'</span>,</span><br><span class="line">        handlers=[loggingFile, ])</span><br></pre></td></tr></table></div></figure>
<p>Declare two methods for sending Email</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_message</span><span class="params">(sender, to, subject, message_text)</span>:</span></span><br><span class="line">  logging.info(<span class="string">"send email::"</span> + message_text)</span><br><span class="line">  from_email = Email(sender)</span><br><span class="line">  to_email = To(to)</span><br><span class="line">  subject = subject</span><br><span class="line">  content = Content(<span class="string">"text/plain"</span>, message_text)</span><br><span class="line">  <span class="keyword">return</span> Mail(from_email, to_email, subject, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_message</span><span class="params">(service, message)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> service.client.mail.send.post(request_body=message.get())</span><br></pre></td></tr></table></div></figure>
<p>Now the mean loop to check the network usage periodically.</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize the SendGrid API</span></span><br><span class="line">service = sendgrid.SendGridAPIClient(api_key=SENDGRID_API_KEY)</span><br><span class="line"></span><br><span class="line"><span class="comment"># A flag to make sure only send one notification</span></span><br><span class="line">have_sent = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  time.sleep(TIME_INTER)</span><br><span class="line">  netio = psutil.net_io_counters(pernic=<span class="literal">True</span>)</span><br><span class="line">  net_usage = netio[NETWORK_INTERFACE].bytes_sent + netio[NETWORK_INTERFACE].bytes_recv</span><br><span class="line">  <span class="keyword">if</span> net_usage &gt; NETWORK_LIMIT <span class="keyword">and</span> <span class="keyword">not</span> have_sent:</span><br><span class="line">    message = create_message(</span><br><span class="line">      config.get(<span class="string">'Email'</span>, <span class="string">'from'</span>),</span><br><span class="line">      config.get(<span class="string">'Email'</span>, <span class="string">'to'</span>),</span><br><span class="line">      config.get(<span class="string">'Email'</span>, <span class="string">'subject'</span>),</span><br><span class="line">      <span class="string">'The network have used %s bytes'</span> %net_usage)</span><br><span class="line">    send_message(service, message)</span><br><span class="line">    have_sent = <span class="literal">True</span></span><br></pre></td></tr></table></div></figure>

        <h2 id="Improvement"   >
          <a href="#Improvement" class="heading-link"><i class="fas fa-link"></i></a>Improvement</h2>
      <ul>
<li>Prevent network usage lost, save the usage in the last email with <code>pickle</code></li>
<li>In order to monitoring network usage continuously, set one more <code>NETWORK_MAX</code> for reseting the flag after first email notification<br>See my <span class="exturl"><a class="exturl__link"   href="https://github.com/NewJerseyStyle/network-monitor"  target="_blank" rel="noopener">GitHub Repo</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://NewJerseyStyle.github.io">NewJerseyStyle</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://newjerseystyle.github.io/en/2020/Network-usage-monitor-using-Python/">https://newjerseystyle.github.io/en/2020/Network-usage-monitor-using-Python/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en zh-tw" rel="external nofollow" target="_blank">BY-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://newjerseystyle.github.io/tags/Raspberry-Pi/">Raspberry Pi</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://newjerseystyle.github.io/tags/Python3/">Python3</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://newjerseystyle.github.io/tags/Monitoring/">Monitoring</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://newjerseystyle.github.io/tags/Email/">Email</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://newjerseystyle.github.io/tags/Coding/">Coding</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/ch-TW/2020/Raspberry-Pi-%E4%BD%BF%E7%94%A8-4G-%E6%95%B8%E6%93%9A%E7%B6%B2%E8%B7%AF/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">Raspberry Pi 使用 4G 數據網路</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/en/2020/Raspberry-Pi-connect-to-4G-LTE/"><span class="paginator-prev__text">Raspberry Pi connect to 4G LTE</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Previous"><span class="toc-number">1.</span> <span class="toc-text">
          Previous</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Goal"><span class="toc-number">2.</span> <span class="toc-text">
          Goal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Requirements-txt"><span class="toc-number">3.</span> <span class="toc-text">
          Requirements.txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coding-Python"><span class="toc-number">4.</span> <span class="toc-text">
          Coding Python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-network-usage"><span class="toc-number">4.1.</span> <span class="toc-text">
          Get network usage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Set-threshold"><span class="toc-number">4.2.</span> <span class="toc-text">
          Set threshold</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Separate-the-config-and-code"><span class="toc-number">4.3.</span> <span class="toc-text">
          Separate the config and code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prepare-for-the-Email"><span class="toc-number">4.4.</span> <span class="toc-text">
          Prepare for the Email</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Generate-SendGrid-API-Key"><span class="toc-number">4.4.1.</span> <span class="toc-text">
          Generate SendGrid API Key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Copy-the-Key-and-paste-to-monitor-conf"><span class="toc-number">4.4.2.</span> <span class="toc-text">
          Copy the Key and paste to monitor.conf</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Write-python-script"><span class="toc-number">4.5.</span> <span class="toc-text">
          Write python script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Improvement"><span class="toc-number">5.</span> <span class="toc-text">
          Improvement</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/logo.png" alt="avatar"></div><p class="sidebar-ov-author__text">NewJerseyStyle</p></div><div class="sidebar-ov-feed"><span class="sidebar-ov-feed-rss"><a class="sidebar-ov-feed-rss__link" href="/atom.xml" target="_blank" rel="noopener"><span class="sidebar-ov-feed-rss__icon"><i class="fas fa-rss"></i></span><span>RSS Subscribe</span></a></span></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">11</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en zh-tw" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2020</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>NewJerseyStyle</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v4.2.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.0.0-rc.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async=""></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-9667639204764993',
  enable_page_level_ads: true
});</script><script src="/js/utils.js?v=2.0.0-rc.0"></script><script src="/js/stun-boot.js?v=2.0.0-rc.0"></script><script src="/js/scroll.js?v=2.0.0-rc.0"></script><script src="/js/header.js?v=2.0.0-rc.0"></script><script src="/js/sidebar.js?v=2.0.0-rc.0"></script></body></html>